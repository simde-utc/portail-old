<?php

/**
 * WeekmailTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class WeekmailTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object WeekmailTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('Weekmail');
    }
    
    public function getCurrent() {
        $q = $this->createQuery('q')
                ->where('q.published_at IS NULL')
                ->orWhere('q.published_at = ?',0)
                ->orderBy('q.created_at ASC');
        return $q;
    }
    
    public function getLast($count = 4) {
        $q = $this->createQuery('q')
                ->where('q.published_at IS NOT NULL')
                ->andWhere('q.published_at <> ?', 0)
                ->orderBy('q.published_at DESC')
                ->limit($count);
        return $q;
    }
    
    public function getLastPublished($count = 1) {
        return $this->getLast($count)->andWhere('q.published_at < NOW()');
    }
}